<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Introduction to TensorFlow | Chan`s Jupyter</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Introduction to TensorFlow" />
<meta name="author" content="Chanseok Kang" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Before you can build advanced models in TensorFlow 2.0, you will first need to understand the basics. In this chapter, you’ll learn how to define constants and variables, perform tensor addition and multiplication, and compute derivatives. Knowledge of linear algebra will be helpful, but not necessary. This is the Summary of lecture “Introduction to TensorFlow in Python”, via datacamp." />
<meta property="og:description" content="Before you can build advanced models in TensorFlow 2.0, you will first need to understand the basics. In this chapter, you’ll learn how to define constants and variables, perform tensor addition and multiplication, and compute derivatives. Knowledge of linear algebra will be helpful, but not necessary. This is the Summary of lecture “Introduction to TensorFlow in Python”, via datacamp." />
<link rel="canonical" href="https://goodboychan.github.io/python/datacamp/tensorflow-keras/deep_learning/2020/07/18/01-Introduction-to-TensorFlow.html" />
<meta property="og:url" content="https://goodboychan.github.io/python/datacamp/tensorflow-keras/deep_learning/2020/07/18/01-Introduction-to-TensorFlow.html" />
<meta property="og:site_name" content="Chan`s Jupyter" />
<meta property="og:image" content="https://goodboychan.github.io/images/tf.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-18T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://goodboychan.github.io/python/datacamp/tensorflow-keras/deep_learning/2020/07/18/01-Introduction-to-TensorFlow.html","headline":"Introduction to TensorFlow","dateModified":"2020-07-18T00:00:00-05:00","datePublished":"2020-07-18T00:00:00-05:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://goodboychan.github.io/python/datacamp/tensorflow-keras/deep_learning/2020/07/18/01-Introduction-to-TensorFlow.html"},"image":"https://goodboychan.github.io/images/tf.png","author":{"@type":"Person","name":"Chanseok Kang"},"description":"Before you can build advanced models in TensorFlow 2.0, you will first need to understand the basics. In this chapter, you’ll learn how to define constants and variables, perform tensor addition and multiplication, and compute derivatives. Knowledge of linear algebra will be helpful, but not necessary. This is the Summary of lecture “Introduction to TensorFlow in Python”, via datacamp.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://goodboychan.github.io/feed.xml" title="Chan`s Jupyter" /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-33905785-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-33905785-1');
</script>


<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>

<script data-ad-client="ca-pub-6747875619665490" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Chan`s Jupyter</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/book/">Book</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Introduction to TensorFlow</h1><p class="page-description">Before you can build advanced models in TensorFlow 2.0, you will first need to understand the basics. In this chapter, you’ll learn how to define constants and variables, perform tensor addition and multiplication, and compute derivatives. Knowledge of linear algebra will be helpful, but not necessary. This is the Summary of lecture "Introduction to TensorFlow in Python", via datacamp.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-07-18T00:00:00-05:00" itemprop="datePublished">
        Jul 18, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Chanseok Kang</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      8 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#Python">Python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Datacamp">Datacamp</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Tensorflow-Keras">Tensorflow-Keras</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Deep_Learning">Deep_Learning</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/goodboychan/goodboychan.github.io/tree/main/_notebooks/2020-07-18-01-Introduction-to-TensorFlow.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/goodboychan/goodboychan.github.io/main?filepath=_notebooks%2F2020-07-18-01-Introduction-to-TensorFlow.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/goodboychan/goodboychan.github.io/blob/main/_notebooks/2020-07-18-01-Introduction-to-TensorFlow.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fgoodboychan%2Fgoodboychan.github.io%2Fblob%2Fmain%2F_notebooks%2F2020-07-18-01-Introduction-to-TensorFlow.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Constants-and-variables">Constants and variables </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Defining-data-as-constants">Defining data as constants </a></li>
<li class="toc-entry toc-h3"><a href="#Defining-variables">Defining variables </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Basic-operations">Basic operations </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Performing-element-wise-multiplication">Performing element-wise multiplication </a></li>
<li class="toc-entry toc-h3"><a href="#Making-predictions-with-matrix-multiplication">Making predictions with matrix multiplication </a></li>
<li class="toc-entry toc-h3"><a href="#Summing-over-tensor-dimensions">Summing over tensor dimensions </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Advanced-operations">Advanced operations </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Reshaping-tensors">Reshaping tensors </a></li>
<li class="toc-entry toc-h3"><a href="#Optimizing-with-gradients">Optimizing with gradients </a></li>
<li class="toc-entry toc-h3"><a href="#Working-with-image-data">Working with image data </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-07-18-01-Introduction-to-TensorFlow.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">tf</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>'2.1.0'</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Constants-and-variables">
<a class="anchor" href="#Constants-and-variables" aria-hidden="true"><span class="octicon octicon-link"></span></a>Constants and variables<a class="anchor-link" href="#Constants-and-variables"> </a>
</h2>
<ul>
<li>Tensorflow<ul>
<li>Open-source library for graph-based numerical computation</li>
<li>Low and high level API<ul>
<li>Addition, multiplication, differentiation</li>
<li>Machine Learning models</li>
</ul>
</li>
<li>In v2.0<ul>
<li>Eager execution by default</li>
<li>Model building with Keras and Estimators</li>
</ul>
</li>
</ul>
</li>
<li>Tensor<ul>
<li>Generalization of vectors and matrices</li>
<li>Collection of numbers</li>
<li>Specific shape</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Defining-data-as-constants">
<a class="anchor" href="#Defining-data-as-constants" aria-hidden="true"><span class="octicon octicon-link"></span></a>Defining data as constants<a class="anchor-link" href="#Defining-data-as-constants"> </a>
</h3>
<p>Throughout this course, we will use <code>tensorflow</code> version 2.1 and will exclusively import the submodules needed to complete each exercise.</p>
<p>you will use it to transform a numpy array, <code>credit_numpy</code>, into a tensorflow constant, <code>credit_constant</code>. This array contains feature columns from a dataset on credit card holders.</p>
<p>Note that tensorflow version 2.0 allows you to use data as either a numpy array or a tensorflow constant object. Using a constant will ensure that any operations performed with that object are done in tensorflow.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">credit</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/credit.csv'</span><span class="p">)</span>
<span class="n">credit_numpy</span> <span class="o">=</span> <span class="n">credit</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">credit</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>1.0</td>
      <td>24.0</td>
      <td>3913.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>2.0</td>
      <td>26.0</td>
      <td>2682.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>2.0</td>
      <td>34.0</td>
      <td>29239.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.0</td>
      <td>1.0</td>
      <td>37.0</td>
      <td>46990.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.0</td>
      <td>1.0</td>
      <td>57.0</td>
      <td>8617.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">credit_constant</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">credit_numpy</span><span class="p">)</span>

<span class="c1"># Print constant datatype</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'The datatype is:'</span><span class="p">,</span> <span class="n">credit_constant</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

<span class="c1"># Print constant shape</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'The shape is:'</span><span class="p">,</span> <span class="n">credit_constant</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The datatype is: &lt;dtype: 'float64'&gt;
The shape is: (30000, 4)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Defining-variables">
<a class="anchor" href="#Defining-variables" aria-hidden="true"><span class="octicon octicon-link"></span></a>Defining variables<a class="anchor-link" href="#Defining-variables"> </a>
</h3>
<p>Unlike a constant, a variable's value can be modified. This will be quite useful when we want to train a model by updating its parameters. Constants can't be used for this purpose, so variables are the natural choice.</p>
<p>Let's try defining and working with a variable.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="c1"># Print the variable A1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A1</span><span class="p">)</span>

<span class="c1"># Convert A1 to a numpy array and assign it to B1</span>
<span class="n">B1</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

<span class="c1"># Print B1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;tf.Variable 'Variable:0' shape=(4,) dtype=int32, numpy=array([1, 2, 3, 4])&gt;
[1 2 3 4]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Basic-operations">
<a class="anchor" href="#Basic-operations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Basic operations<a class="anchor-link" href="#Basic-operations"> </a>
</h2>
<ul>
<li>TensorFlow operation<ul>
<li>model of computation that revolves around the use of graphs</li>
<li>Graph contains edges and nodes, where edges are tensors and the nodes are operations</li>
</ul>
</li>
<li>Performing tensor addition<ul>
<li>The <code>add()</code> operation performs <strong>element-wise addition</strong> with two tensors</li>
<li>Element-wise addition requires both tensors to have the same shape:<ul>
<li>Scalar addition: $1 + 2 = 3$</li>
<li>Vector addition: $[1, 2] + [3, 4] = [4, 6]$</li>
<li>Matrix addition: $\begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{bmatrix} + \begin{bmatrix} 5 &amp; 6 \\ 7 &amp; 8 \end{bmatrix} = \begin{bmatrix} 6 &amp; 8 \\ 10 &amp; 12 \end{bmatrix}$</li>
</ul>
</li>
<li>Operator is overloaded with $+$</li>
</ul>
</li>
<li>Performing tensor multiplication<ul>
<li>
<strong>Element-wise multiplication</strong> performed using <code>multiply()</code> operation</li>
<li>Matrix multiplication performed with <code>matmul()</code> operator<ul>
<li>The <code>matmul(A, B)</code> operation multiplies A by B</li>
<li>Number of columns of A must equal the number of rows of B</li>
</ul>
</li>
</ul>
</li>
<li>Summing over tensor dimensions<ul>
<li>The <code>reduce_sum()</code> operator sums over the dimensions of a tensor<ul>
<li>
<code>reduce_sum(A)</code> sums over all dimensions of A</li>
<li>
<code>reduce_sum(A, i)</code> sums over dimension i</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Performing-element-wise-multiplication">
<a class="anchor" href="#Performing-element-wise-multiplication" aria-hidden="true"><span class="octicon octicon-link"></span></a>Performing element-wise multiplication<a class="anchor-link" href="#Performing-element-wise-multiplication"> </a>
</h3>
<p>Element-wise multiplication in TensorFlow is performed using two tensors with identical shapes. This is because the operation multiplies elements in corresponding positions in the two tensors. An example of an element-wise multiplication, denoted by the $\odot$ symbol, is shown below:</p>
<p>
$$ \begin{bmatrix} 1 &amp; 2 \\ 2 &amp; 1 \end{bmatrix} \odot \begin{bmatrix} 3 &amp; 1 \\ 2 &amp; 5 \end{bmatrix} = \begin{bmatrix} 3 &amp; 2 \\ 4 &amp; 5 \end{bmatrix} $$
</p>
<p>In this exercise, you will perform element-wise multiplication, paying careful attention to the shape of the tensors you multiply.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">A23</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>

<span class="c1"># Define B1 and B23 to have the correct shape</span>
<span class="n">B1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">A1</span><span class="p">)</span>
<span class="n">B23</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">A23</span><span class="p">)</span>

<span class="c1"># Perform element-wise multiplication</span>
<span class="n">C1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">B1</span><span class="p">)</span>
<span class="n">C23</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">A23</span><span class="p">,</span> <span class="n">B23</span><span class="p">)</span>

<span class="c1"># Print the tensors C1 and C23</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'C1: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">C1</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'C23: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">C23</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>C1: [1 2 3 4]
C23: [[1 2 3]
 [1 6 4]]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice how performing element-wise multiplication with tensors of ones leaves the original tensors unchanged.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Making-predictions-with-matrix-multiplication">
<a class="anchor" href="#Making-predictions-with-matrix-multiplication" aria-hidden="true"><span class="octicon octicon-link"></span></a>Making predictions with matrix multiplication<a class="anchor-link" href="#Making-predictions-with-matrix-multiplication"> </a>
</h3>
<p>In later chapters, you will learn to train linear regression models. This process will yield a vector of parameters that can be multiplied by the input data to generate predictions. In this exercise, you will use input data, <code>features</code>, and a target vector, <code>bill</code>, which are taken from a credit card dataset we will use later in the course.</p>
$$ \text{features} = \begin{bmatrix} 2 &amp; 24 \\ 2 &amp; 26 \\ 2 &amp; 57 \\ 1 &amp; 37 \end{bmatrix}, 
\text{bill} = \begin{bmatrix} 3913 \\ 2682 \\ 8617 \\ 64400 \end{bmatrix}, \text{params} = \begin{bmatrix} 1000 \\ 150 \end{bmatrix} $$<p>The matrix of input data, <code>features</code>, contains two columns: education level and age. The target vector, <code>bill</code>, is the size of the credit card borrower's bill.</p>
<p>Since we have not trained the model, you will enter a guess for the values of the parameter vector, <code>params</code>. You will then use <code>matmul()</code> to perform matrix multiplication of features by <code>params</code> to generate predictions, <code>billpred</code>, which you will compare with <code>bill</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">26</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">57</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">37</span><span class="p">]])</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mi">1000</span><span class="p">],</span> <span class="p">[</span><span class="mi">150</span><span class="p">]])</span>
<span class="n">bill</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mi">3913</span><span class="p">],</span> <span class="p">[</span><span class="mi">2682</span><span class="p">],</span> <span class="p">[</span><span class="mi">8617</span><span class="p">],</span> <span class="p">[</span><span class="mi">64400</span><span class="p">]])</span>

<span class="c1"># Compute billpred using features and params</span>
<span class="n">billpred</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

<span class="c1"># Compute and print the error</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">bill</span> <span class="o">-</span> <span class="n">billpred</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[-1687]
 [-3218]
 [-1933]
 [57850]]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Summing-over-tensor-dimensions">
<a class="anchor" href="#Summing-over-tensor-dimensions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Summing over tensor dimensions<a class="anchor-link" href="#Summing-over-tensor-dimensions"> </a>
</h3>
<p>You've been given a matrix, <code>wealth</code>. This contains the value of bond and stock wealth for five individuals in thousands of dollars.

$$\text{wealth} = \begin{bmatrix} 11 &amp; 50 \\ 7 &amp; 2 \\ 4 &amp; 60 \\ 3 &amp; 0 \\ 25 &amp; 10 \end{bmatrix} $$
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first column corresponds to bonds and the second corresponds to stocks. Each row gives the bond and stock wealth for a single individual.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wealth</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">wealth</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(), dtype=int32, numpy=172&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">wealth</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(5,), dtype=int32, numpy=array([61,  9, 64,  3, 35])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Advanced-operations">
<a class="anchor" href="#Advanced-operations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Advanced operations<a class="anchor-link" href="#Advanced-operations"> </a>
</h2>
<ul>
<li>Finding th optimum<ul>
<li>In many problems, we will want to find the optimum of a function<ul>
<li>Minimum: Lowest value of a loss function</li>
<li>Maximum: Highest value of objective function</li>
</ul>
</li>
<li>We can do this using the <code>gradient()</code> operation<ul>
<li>Optimum: Find a point where gradient = 0</li>
<li>Minimum: Change in gradient &gt; 0</li>
<li>Maximum: Change in gradient &lt; 0</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Reshaping-tensors">
<a class="anchor" href="#Reshaping-tensors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reshaping tensors<a class="anchor-link" href="#Reshaping-tensors"> </a>
</h3>
<p>Later in the course, you will classify images of sign language letters using a neural network. In some cases, the network will take 1-dimensional tensors as inputs, but your data will come in the form of images, which will either be either 2- or 3-dimensional tensors, depending on whether they are grayscale or color images.</p>
<p>The figure below shows grayscale and color images of the sign language letter A. The two images have been imported for you and converted to the numpy arrays <code>gray_tensor</code> and <code>color_tensor</code>. Reshape these arrays into 1-dimensional vectors using the <code>reshape</code> operation, which has been imported for you from tensorflow. Note that the shape of <code>gray_tensor</code> is 28x28 and the shape of <code>color_tensor</code> is 28x28x3.
<img src="/images/copied_from_nb/image/sign_1_10.jpg" alt="sign"></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gray_tensor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/gray_tensor.csv'</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="n">color_tensor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/color_tensor.csv'</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gray_tensor</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">);</span>
<span class="c1"># plt.imshow(image, interpolation='nearest')</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gray_vector</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">gray_tensor</span><span class="p">,</span> <span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Reshape the color image tensor into a vector</span>
<span class="n">color_vector</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">color_tensor</span><span class="p">,</span> <span class="p">(</span><span class="mi">2352</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Optimizing-with-gradients">
<a class="anchor" href="#Optimizing-with-gradients" aria-hidden="true"><span class="octicon octicon-link"></span></a>Optimizing with gradients<a class="anchor-link" href="#Optimizing-with-gradients"> </a>
</h3>
<p>You are given a loss function, <code>y=x^2</code>, which you want to minimize. You can do this by computing the slope using the <code>GradientTape()</code> operation at different values of <code>x</code>. If the slope is positive, you can decrease the loss by lowering <code>x</code>. If it is negative, you can decrease it by increasing <code>x</code>. This is how gradient descent works.
<img src="/images/copied_from_nb/image/gradient_plot.png" alt="gradient"></p>
<p>In practice, you will use a high level tensorflow operation to perform gradient descent automatically. In this exercise, however, you will compute the slope at x values of -1, 1, and 0.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">compute_gradient</span><span class="p">(</span><span class="n">x0</span><span class="p">):</span>
    <span class="c1"># Define x as a variable with an initial value of x0</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>
        <span class="n">tape</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1"># Define y using the multiply operation</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
    <span class="c1"># Return the gradient of y with respect to x</span>
    <span class="k">return</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

<span class="c1"># Compute and print gradients at x = -1, 1, and 0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">compute_gradient</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">compute_gradient</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">compute_gradient</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>-2.0
2.0
0.0
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that the slope is positive at x = 1, which means that we can lower the loss by reducing x. The slope is negative at x = -1, which means that we can lower the loss by increasing x. The slope at x = 0 is 0, which means that we cannot lower the loss by either increasing or decreasing x. This is because the loss is minimized at x = 0.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Working-with-image-data">
<a class="anchor" href="#Working-with-image-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Working with image data<a class="anchor-link" href="#Working-with-image-data"> </a>
</h3>
<p>You are given a black-and-white image of a letter, which has been encoded as a tensor, <code>letter</code>. You want to determine whether the letter is an X or a K. You don't have a trained neural network, but you do have a simple model, <code>model</code>, which can be used to classify <code>letter</code>.</p>
<p>The 3x3 tensor, <code>letter</code>, and the 1x3 tensor, <code>model</code>, are available in the Python shell. You can determine whether letter is a K by multiplying letter by model, summing over the result, and then checking if it is equal to 1. As with more complicated models, such as neural networks, <code>model</code> is a collection of weights, arranged in a tensor.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">letter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]</span> <span class="p">])</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Multiply letter by model</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>

<span class="c1"># Sum over output and print prediction using the numpy method</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prediction</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1.0
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Your model found that <code>prediction</code>=1.0 and correctly classified the letter as a K. In the coming chapters, you will use data to train a model, <code>model</code>, and then combine this with matrix multiplication, <code>matmul(letter, model)</code>, as we have done here, to make predictions about the classes of objects.</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="goodboychan/goodboychan.github.io"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/python/datacamp/tensorflow-keras/deep_learning/2020/07/18/01-Introduction-to-TensorFlow.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="https://goodboychan.github.io/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://github.com/goodboychan" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://www.linkedin.com/in/chanseokk/" target="_blank" title="linkedin">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#linkedin"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>

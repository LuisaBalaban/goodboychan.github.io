<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Selecting features for modeling | Chan`s Jupyter</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Selecting features for modeling" />
<meta name="author" content="Chanseok Kang" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This chapter goes over a few different techniques for selecting the most important features from your dataset. You’ll learn how to drop redundant features, work with text vectors, and reduce the number of features in your dataset using principal component analysis (PCA). This is the Summary of lecture “Preprocessing for Machine Learning in Python”, via datacamp." />
<meta property="og:description" content="This chapter goes over a few different techniques for selecting the most important features from your dataset. You’ll learn how to drop redundant features, work with text vectors, and reduce the number of features in your dataset using principal component analysis (PCA). This is the Summary of lecture “Preprocessing for Machine Learning in Python”, via datacamp." />
<link rel="canonical" href="https://goodboychan.github.io/python/datacamp/machine_learning/2020/07/10/01-Selecting-features-for-modeling.html" />
<meta property="og:url" content="https://goodboychan.github.io/python/datacamp/machine_learning/2020/07/10/01-Selecting-features-for-modeling.html" />
<meta property="og:site_name" content="Chan`s Jupyter" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-10T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://goodboychan.github.io/python/datacamp/machine_learning/2020/07/10/01-Selecting-features-for-modeling.html","@type":"BlogPosting","headline":"Selecting features for modeling","dateModified":"2020-07-10T00:00:00-05:00","datePublished":"2020-07-10T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://goodboychan.github.io/python/datacamp/machine_learning/2020/07/10/01-Selecting-features-for-modeling.html"},"author":{"@type":"Person","name":"Chanseok Kang"},"description":"This chapter goes over a few different techniques for selecting the most important features from your dataset. You’ll learn how to drop redundant features, work with text vectors, and reduce the number of features in your dataset using principal component analysis (PCA). This is the Summary of lecture “Preprocessing for Machine Learning in Python”, via datacamp.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://goodboychan.github.io/feed.xml" title="Chan`s Jupyter" /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-33905785-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-33905785-1');
</script>


<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>

<script data-ad-client="ca-pub-6747875619665490" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Chan`s Jupyter</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/book/">Book</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Selecting features for modeling</h1><p class="page-description">This chapter goes over a few different techniques for selecting the most important features from your dataset. You'll learn how to drop redundant features, work with text vectors, and reduce the number of features in your dataset using principal component analysis (PCA). This is the Summary of lecture "Preprocessing for Machine Learning in Python", via datacamp.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-07-10T00:00:00-05:00" itemprop="datePublished">
        Jul 10, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Chanseok Kang</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      8 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#Python">Python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Datacamp">Datacamp</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Machine_Learning">Machine_Learning</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/goodboychan/goodboychan.github.io/tree/main/_notebooks/2020-07-10-01-Selecting-features-for-modeling.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/goodboychan/goodboychan.github.io/main?filepath=_notebooks%2F2020-07-10-01-Selecting-features-for-modeling.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/goodboychan/goodboychan.github.io/blob/main/_notebooks/2020-07-10-01-Selecting-features-for-modeling.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fgoodboychan%2Fgoodboychan.github.io%2Fblob%2Fmain%2F_notebooks%2F2020-07-10-01-Selecting-features-for-modeling.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Feature-selection">Feature selection </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Identifying-areas-for-feature-selection">Identifying areas for feature selection </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Removing-redundant-features">Removing redundant features </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Selecting-relevant-features">Selecting relevant features </a></li>
<li class="toc-entry toc-h3"><a href="#Checking-for-correlated-features">Checking for correlated features </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Selecting-features-using-text-vectors">Selecting features using text vectors </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Exploring-text-vectors,-part-1">Exploring text vectors, part 1 </a></li>
<li class="toc-entry toc-h3"><a href="#Exploring-text-vectors,-part-2">Exploring text vectors, part 2 </a></li>
<li class="toc-entry toc-h3"><a href="#Training-Naive-Bayes-with-feature-selection">Training Naive Bayes with feature selection </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Dimensionality-reduction">Dimensionality reduction </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Using-PCA">Using PCA </a></li>
<li class="toc-entry toc-h3"><a href="#Training-a-model-with-PCA">Training a model with PCA </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-07-10-01-Selecting-features-for-modeling.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Feature-selection">
<a class="anchor" href="#Feature-selection" aria-hidden="true"><span class="octicon octicon-link"></span></a>Feature selection<a class="anchor-link" href="#Feature-selection"> </a>
</h2>
<ul>
<li>Selecting features to be used for modeling</li>
<li>Doesn't create new features</li>
<li>Improve model's performance</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Identifying-areas-for-feature-selection">
<a class="anchor" href="#Identifying-areas-for-feature-selection" aria-hidden="true"><span class="octicon octicon-link"></span></a>Identifying areas for feature selection<a class="anchor-link" href="#Identifying-areas-for-feature-selection"> </a>
</h3>
<p>Take an exploratory look at the post-feature engineering <code>hiking</code> dataset.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hiking</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">'./dataset/hiking.json'</span><span class="p">)</span>
<span class="n">hiking</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Prop_ID</th>
      <th>Name</th>
      <th>Location</th>
      <th>Park_Name</th>
      <th>Length</th>
      <th>Difficulty</th>
      <th>Other_Details</th>
      <th>Accessible</th>
      <th>Limited_Access</th>
      <th>lat</th>
      <th>lon</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B057</td>
      <td>Salt Marsh Nature Trail</td>
      <td>Enter behind the Salt Marsh Nature Center, loc...</td>
      <td>Marine Park</td>
      <td>0.8 miles</td>
      <td>None</td>
      <td>&lt;p&gt;The first half of this mile-long trail foll...</td>
      <td>Y</td>
      <td>N</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B073</td>
      <td>Lullwater</td>
      <td>Enter Park at Lincoln Road and Ocean Avenue en...</td>
      <td>Prospect Park</td>
      <td>1.0 mile</td>
      <td>Easy</td>
      <td>Explore the Lullwater to see how nature thrive...</td>
      <td>N</td>
      <td>N</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B073</td>
      <td>Midwood</td>
      <td>Enter Park at Lincoln Road and Ocean Avenue en...</td>
      <td>Prospect Park</td>
      <td>0.75 miles</td>
      <td>Easy</td>
      <td>Step back in time with a walk through Brooklyn...</td>
      <td>N</td>
      <td>N</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B073</td>
      <td>Peninsula</td>
      <td>Enter Park at Lincoln Road and Ocean Avenue en...</td>
      <td>Prospect Park</td>
      <td>0.5 miles</td>
      <td>Easy</td>
      <td>Discover how the Peninsula has changed over th...</td>
      <td>N</td>
      <td>N</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B073</td>
      <td>Waterfall</td>
      <td>Enter Park at Lincoln Road and Ocean Avenue en...</td>
      <td>Prospect Park</td>
      <td>0.5 miles</td>
      <td>Easy</td>
      <td>Trace the source of the Lake on the Waterfall ...</td>
      <td>N</td>
      <td>N</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Removing-redundant-features">
<a class="anchor" href="#Removing-redundant-features" aria-hidden="true"><span class="octicon octicon-link"></span></a>Removing redundant features<a class="anchor-link" href="#Removing-redundant-features"> </a>
</h2>
<ul>
<li>Remove noisy features</li>
<li>Remove correlated features<ul>
<li>Statistically correlated: features move together directionally</li>
<li>Linear models assume feature independence</li>
<li>Pearson correlation coefficient</li>
</ul>
</li>
<li>Remove duplicated features</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Selecting-relevant-features">
<a class="anchor" href="#Selecting-relevant-features" aria-hidden="true"><span class="octicon octicon-link"></span></a>Selecting relevant features<a class="anchor-link" href="#Selecting-relevant-features"> </a>
</h3>
<p>Now let's identify the redundant columns in the <code>volunteer</code> dataset and perform feature selection on the dataset to return a DataFrame of the relevant features.</p>
<p>For example, if you explore the <code>volunteer</code> dataset in the console, you'll see three features which are related to location: <code>locality</code>, <code>region</code>, and <code>postalcode</code>. They contain repeated information, so it would make sense to keep only one of the features.</p>
<p>There are also features that have gone through the feature engineering process: columns like <code>Education</code> and <code>Emergency Preparedness</code> are a product of encoding the categorical variable <code>category_desc</code>, so <code>category_desc</code> itself is redundant now.</p>
<p>Take a moment to examine the features of volunteer in the console, and try to identify the redundant features.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">volunteer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/volunteer_sample.csv'</span><span class="p">)</span>
<span class="n">volunteer</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'category_desc'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">volunteer</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>vol_requests</th>
      <th>title</th>
      <th>hits</th>
      <th>category_desc</th>
      <th>locality</th>
      <th>region</th>
      <th>postalcode</th>
      <th>created_date</th>
      <th>vol_requests_lognorm</th>
      <th>created_month</th>
      <th>Education</th>
      <th>Emergency Preparedness</th>
      <th>Environment</th>
      <th>Health</th>
      <th>Helping Neighbors in Need</th>
      <th>Strengthening Communities</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Web designer</td>
      <td>22</td>
      <td>Strengthening Communities</td>
      <td>5 22nd St\nNew York, NY 10010\n(40.74053152272...</td>
      <td>NY</td>
      <td>10010.0</td>
      <td>2011-01-14</td>
      <td>0.693147</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>Urban Adventures - Ice Skating at Lasker Rink</td>
      <td>62</td>
      <td>Strengthening Communities</td>
      <td>NaN</td>
      <td>NY</td>
      <td>10026.0</td>
      <td>2011-01-19</td>
      <td>2.995732</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>500</td>
      <td>Fight global hunger and support women farmers ...</td>
      <td>14</td>
      <td>Strengthening Communities</td>
      <td>NaN</td>
      <td>NY</td>
      <td>2114.0</td>
      <td>2011-01-21</td>
      <td>6.214608</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>Stop 'N' Swap</td>
      <td>31</td>
      <td>Environment</td>
      <td>NaN</td>
      <td>NY</td>
      <td>10455.0</td>
      <td>2011-01-28</td>
      <td>2.708050</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>15</td>
      <td>Queens Stop 'N' Swap</td>
      <td>135</td>
      <td>Environment</td>
      <td>NaN</td>
      <td>NY</td>
      <td>11372.0</td>
      <td>2011-01-28</td>
      <td>2.708050</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">volunteer</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index(['vol_requests', 'title', 'hits', 'category_desc', 'locality', 'region',
       'postalcode', 'created_date', 'vol_requests_lognorm', 'created_month',
       'Education', 'Emergency Preparedness', 'Environment', 'Health',
       'Helping Neighbors in Need', 'Strengthening Communities'],
      dtype='object')</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"locality"</span><span class="p">,</span> <span class="s2">"region"</span><span class="p">,</span> <span class="s2">"category_desc"</span><span class="p">,</span> <span class="s2">"created_date"</span><span class="p">,</span> <span class="s2">"vol_requests"</span><span class="p">]</span>

<span class="c1"># Drop those columns from the dataset</span>
<span class="n">volunteer_subset</span> <span class="o">=</span> <span class="n">volunteer</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">to_drop</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Print out the head of the new dataset</span>
<span class="n">volunteer_subset</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>hits</th>
      <th>postalcode</th>
      <th>vol_requests_lognorm</th>
      <th>created_month</th>
      <th>Education</th>
      <th>Emergency Preparedness</th>
      <th>Environment</th>
      <th>Health</th>
      <th>Helping Neighbors in Need</th>
      <th>Strengthening Communities</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Web designer</td>
      <td>22</td>
      <td>10010.0</td>
      <td>0.693147</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Urban Adventures - Ice Skating at Lasker Rink</td>
      <td>62</td>
      <td>10026.0</td>
      <td>2.995732</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Fight global hunger and support women farmers ...</td>
      <td>14</td>
      <td>2114.0</td>
      <td>6.214608</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Stop 'N' Swap</td>
      <td>31</td>
      <td>10455.0</td>
      <td>2.708050</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Queens Stop 'N' Swap</td>
      <td>135</td>
      <td>11372.0</td>
      <td>2.708050</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Checking-for-correlated-features">
<a class="anchor" href="#Checking-for-correlated-features" aria-hidden="true"><span class="octicon octicon-link"></span></a>Checking for correlated features<a class="anchor-link" href="#Checking-for-correlated-features"> </a>
</h3>
<p>Let's take a look at the <code>wine</code> dataset again, which is made up of continuous, numerical features. Run Pearson's correlation coefficient on the dataset to determine which columns are good candidates for eliminating. Then, remove those columns from the DataFrame.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wine</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/wine_sample.csv'</span><span class="p">)</span>
<span class="n">wine</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Flavanoids</th>
      <th>Total phenols</th>
      <th>Malic acid</th>
      <th>OD280/OD315 of diluted wines</th>
      <th>Hue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.06</td>
      <td>2.80</td>
      <td>1.71</td>
      <td>3.92</td>
      <td>1.04</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.76</td>
      <td>2.65</td>
      <td>1.78</td>
      <td>3.40</td>
      <td>1.05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.24</td>
      <td>2.80</td>
      <td>2.36</td>
      <td>3.17</td>
      <td>1.03</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.49</td>
      <td>3.85</td>
      <td>1.95</td>
      <td>3.45</td>
      <td>0.86</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.69</td>
      <td>2.80</td>
      <td>2.59</td>
      <td>2.93</td>
      <td>1.04</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">wine</span><span class="o">.</span><span class="n">corr</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>                              Flavanoids  Total phenols  Malic acid  \
Flavanoids                      1.000000       0.864564   -0.411007   
Total phenols                   0.864564       1.000000   -0.335167   
Malic acid                     -0.411007      -0.335167    1.000000   
OD280/OD315 of diluted wines    0.787194       0.699949   -0.368710   
Hue                             0.543479       0.433681   -0.561296   

                              OD280/OD315 of diluted wines       Hue  
Flavanoids                                        0.787194  0.543479  
Total phenols                                     0.699949  0.433681  
Malic acid                                       -0.368710 -0.561296  
OD280/OD315 of diluted wines                      1.000000  0.565468  
Hue                                               0.565468  1.000000  
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to_drop</span> <span class="o">=</span> <span class="s2">"Flavanoids"</span>

<span class="c1"># Drop that column from the DataFrame</span>
<span class="n">wine</span> <span class="o">=</span> <span class="n">wine</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">to_drop</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Selecting-features-using-text-vectors">
<a class="anchor" href="#Selecting-features-using-text-vectors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Selecting features using text vectors<a class="anchor-link" href="#Selecting-features-using-text-vectors"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Exploring-text-vectors,-part-1">
<a class="anchor" href="#Exploring-text-vectors,-part-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exploring text vectors, part 1<a class="anchor-link" href="#Exploring-text-vectors,-part-1"> </a>
</h3>
<p>Let's expand on the text vector exploration method we just learned about, using the <code>volunteer</code> dataset's title tf/idf vectors. In this first part of text vector exploration, we're going to add to that function we learned about in the slides. We'll return a list of numbers with the function. In the next exercise, we'll write another function to collect the top words across all documents, extract them, and then use that list to filter down our <code>text_tfidf</code> vector.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/vocab_volunteer.csv'</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">vocab</span> <span class="o">=</span> <span class="n">vocab_csv</span><span class="p">[</span><span class="s1">'0'</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">volunteer</span> <span class="o">=</span> <span class="n">volunteer</span><span class="p">[[</span><span class="s1">'category_desc'</span><span class="p">,</span> <span class="s1">'title'</span><span class="p">]]</span>
<span class="n">volunteer</span> <span class="o">=</span> <span class="n">volunteer</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'category_desc'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>

<span class="c1"># Take the title text</span>
<span class="n">title_text</span> <span class="o">=</span> <span class="n">volunteer</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span>

<span class="c1"># Create the vectorizer method</span>
<span class="n">tfidf_vec</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>

<span class="c1"># Transform the text into tf-idf vectors</span>
<span class="n">text_tfidf</span> <span class="o">=</span> <span class="n">tfidf_vec</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">title_text</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">return_weights</span><span class="p">(</span><span class="n">vocab</span><span class="p">,</span> <span class="n">original_vocab</span><span class="p">,</span> <span class="n">vector</span><span class="p">,</span> <span class="n">vector_index</span><span class="p">,</span> <span class="n">top_n</span><span class="p">):</span>
    <span class="n">zipped</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">vector</span><span class="p">[</span><span class="n">vector_index</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="n">vector</span><span class="p">[</span><span class="n">vector_index</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
    
    <span class="c1"># Let's transform that zipped dict into a series</span>
    <span class="n">zipped_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="n">vocab</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span><span class="n">zipped</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector</span><span class="p">[</span><span class="n">vector_index</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">})</span>
    
    <span class="c1"># Let's sort the series to pull out the top n weighted words</span>
    <span class="n">zipped_index</span> <span class="o">=</span> <span class="n">zipped_series</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="n">top_n</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">original_vocab</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">zipped_index</span><span class="p">]</span>

<span class="c1"># Print out the weighted words</span>
<span class="nb">print</span><span class="p">(</span><span class="n">return_weights</span><span class="p">(</span><span class="n">vocab</span><span class="p">,</span> <span class="n">tfidf_vec</span><span class="o">.</span><span class="n">vocabulary_</span><span class="p">,</span> <span class="n">text_tfidf</span><span class="p">,</span> <span class="n">vector_index</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[189, 942, 466]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Exploring-text-vectors,-part-2">
<a class="anchor" href="#Exploring-text-vectors,-part-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exploring text vectors, part 2<a class="anchor-link" href="#Exploring-text-vectors,-part-2"> </a>
</h3>
<p>Using the function we wrote in the previous exercise, we're going to extract the top words from each document in the text vector, return a list of the word indices, and use that list to filter the text vector down to those top words.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">words_to_filter</span><span class="p">(</span><span class="n">vocab</span><span class="p">,</span> <span class="n">original_vocab</span><span class="p">,</span> <span class="n">vector</span><span class="p">,</span> <span class="n">top_n</span><span class="p">):</span>
    <span class="n">filter_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="c1"># here we'll call the function from the previous exercise, </span>
        <span class="c1"># and extend the list we're creating</span>
        <span class="n">filtered</span> <span class="o">=</span> <span class="n">return_weights</span><span class="p">(</span><span class="n">vocab</span><span class="p">,</span> <span class="n">original_vocab</span><span class="p">,</span> <span class="n">vector</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">top_n</span><span class="p">)</span>
        <span class="n">filter_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">filtered</span><span class="p">)</span>
    <span class="c1"># Return the list in a set, so we don't get duplicate word indices</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">filter_list</span><span class="p">)</span>

<span class="c1"># Call the function to get the list of word indices</span>
<span class="n">filtered_words</span> <span class="o">=</span> <span class="n">words_to_filter</span><span class="p">(</span><span class="n">vocab</span><span class="p">,</span> <span class="n">tfidf_vec</span><span class="o">.</span><span class="n">vocabulary_</span><span class="p">,</span> <span class="n">text_tfidf</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># By converting filtered_words back to a list, </span>
<span class="c1"># we can use it to filter the columns in the text vector</span>
<span class="n">filtered_text</span> <span class="o">=</span> <span class="n">text_tfidf</span><span class="p">[:,</span> <span class="nb">list</span><span class="p">(</span><span class="n">filtered_words</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training-Naive-Bayes-with-feature-selection">
<a class="anchor" href="#Training-Naive-Bayes-with-feature-selection" aria-hidden="true"><span class="octicon octicon-link"></span></a>Training Naive Bayes with feature selection<a class="anchor-link" href="#Training-Naive-Bayes-with-feature-selection"> </a>
</h3>
<p>Let's re-run the Naive Bayes text classification model we ran at the end of chapter 3, with our selection choices from the previous exercise, on the <code>volunteer</code> dataset's <code>title</code> and <code>category_desc</code> columns.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>

<span class="n">nb</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">volunteer</span><span class="p">[</span><span class="s1">'category_desc'</span><span class="p">]</span>

<span class="c1"># Split the dataset according to the class distribution of category_desc,</span>
<span class="c1"># using the filtered_text vector</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">filtered_text</span><span class="o">.</span><span class="n">toarray</span><span class="p">(),</span> <span class="n">y</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Fit the model to the training data</span>
<span class="n">nb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Print out the model's accuracy</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nb</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.5483870967741935
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can see that our accuracy score wasn't that different from the score at the end of chapter 3. That's okay; the <code>title</code> field is a very small text field, appropriate for demonstrating how filtering vectors works.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dimensionality-reduction">
<a class="anchor" href="#Dimensionality-reduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dimensionality reduction<a class="anchor-link" href="#Dimensionality-reduction"> </a>
</h2>
<ul>
<li>Unsupervised learning method</li>
<li>Combine/decomposes a feature space</li>
<li>Feature extraction</li>
<li>Principal component analysis<ul>
<li>Linear transformation to uncorrelated space</li>
<li>Captures as much variance as possible in each component</li>
</ul>
</li>
<li>PCA caveats<ul>
<li>Difficult to interpret components</li>
<li>End of preprocessing journey</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Using-PCA">
<a class="anchor" href="#Using-PCA" aria-hidden="true"><span class="octicon octicon-link"></span></a>Using PCA<a class="anchor-link" href="#Using-PCA"> </a>
</h3>
<p>Let's apply PCA to the <code>wine</code> dataset, to see if we can get an increase in our model's accuracy.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wine</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/wine_types.csv'</span><span class="p">)</span>
<span class="n">wine</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Type</th>
      <th>Alcohol</th>
      <th>Malic acid</th>
      <th>Ash</th>
      <th>Alcalinity of ash</th>
      <th>Magnesium</th>
      <th>Total phenols</th>
      <th>Flavanoids</th>
      <th>Nonflavanoid phenols</th>
      <th>Proanthocyanins</th>
      <th>Color intensity</th>
      <th>Hue</th>
      <th>OD280/OD315 of diluted wines</th>
      <th>Proline</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>14.23</td>
      <td>1.71</td>
      <td>2.43</td>
      <td>15.6</td>
      <td>127</td>
      <td>2.80</td>
      <td>3.06</td>
      <td>0.28</td>
      <td>2.29</td>
      <td>5.64</td>
      <td>1.04</td>
      <td>3.92</td>
      <td>1065</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>13.20</td>
      <td>1.78</td>
      <td>2.14</td>
      <td>11.2</td>
      <td>100</td>
      <td>2.65</td>
      <td>2.76</td>
      <td>0.26</td>
      <td>1.28</td>
      <td>4.38</td>
      <td>1.05</td>
      <td>3.40</td>
      <td>1050</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>13.16</td>
      <td>2.36</td>
      <td>2.67</td>
      <td>18.6</td>
      <td>101</td>
      <td>2.80</td>
      <td>3.24</td>
      <td>0.30</td>
      <td>2.81</td>
      <td>5.68</td>
      <td>1.03</td>
      <td>3.17</td>
      <td>1185</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>14.37</td>
      <td>1.95</td>
      <td>2.50</td>
      <td>16.8</td>
      <td>113</td>
      <td>3.85</td>
      <td>3.49</td>
      <td>0.24</td>
      <td>2.18</td>
      <td>7.80</td>
      <td>0.86</td>
      <td>3.45</td>
      <td>1480</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>13.24</td>
      <td>2.59</td>
      <td>2.87</td>
      <td>21.0</td>
      <td>118</td>
      <td>2.80</td>
      <td>2.69</td>
      <td>0.39</td>
      <td>1.82</td>
      <td>4.32</td>
      <td>1.04</td>
      <td>2.93</td>
      <td>735</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="c1"># Set up PCA and the X vector for dimensionality reduction</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span>
<span class="n">wine_X</span> <span class="o">=</span> <span class="n">wine</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'Type'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Apply PCA to the wine dataset X vector</span>
<span class="n">transformed_X</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">wine_X</span><span class="p">)</span>

<span class="c1"># Look at the percentage of variance explained by the different components</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[9.98091230e-01 1.73591562e-03 9.49589576e-05 5.02173562e-05
 1.23636847e-05 8.46213034e-06 2.80681456e-06 1.52308053e-06
 1.12783044e-06 7.21415811e-07 3.78060267e-07 2.12013755e-07
 8.25392788e-08]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training-a-model-with-PCA">
<a class="anchor" href="#Training-a-model-with-PCA" aria-hidden="true"><span class="octicon octicon-link"></span></a>Training a model with PCA<a class="anchor-link" href="#Training-a-model-with-PCA"> </a>
</h3>
<p>Now that we have run PCA on the <code>wine</code> dataset, let's try training a model with it.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">wine</span><span class="p">[</span><span class="s1">'Type'</span><span class="p">]</span>

<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>

<span class="c1"># Split the transformed X and the y labels into training and test sets</span>
<span class="n">X_wine_train</span><span class="p">,</span> <span class="n">X_wine_test</span><span class="p">,</span> <span class="n">y_wine_train</span><span class="p">,</span> <span class="n">y_wine_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">transformed_X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Fit knn to the training data</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_wine_train</span><span class="p">,</span> <span class="n">y_wine_train</span><span class="p">)</span>

<span class="c1"># Score knn on the test data and print it out</span>
<span class="nb">print</span><span class="p">(</span><span class="n">knn</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_wine_test</span><span class="p">,</span> <span class="n">y_wine_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.7555555555555555
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="goodboychan/goodboychan.github.io"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/python/datacamp/machine_learning/2020/07/10/01-Selecting-features-for-modeling.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/goodboychan" target="_blank" title="goodboychan"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/chanseokk" target="_blank" title="chanseokk"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" target="_blank" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>

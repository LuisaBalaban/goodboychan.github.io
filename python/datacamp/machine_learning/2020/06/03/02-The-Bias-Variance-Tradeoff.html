<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">The Bias-Variance Tradeoff</h1><p class="page-description">A Summary of lecture "Machine Learning with Tree-Based Models in Python</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-06-03T00:00:00-05:00" itemprop="datePublished">
        Jun 3, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Chanseok Kang</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      7 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#Python">Python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Datacamp">Datacamp</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Machine_Learning">Machine_Learning</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/goodboychan/goodboychan.github.io/tree/main/_notebooks/2020-06-03-02-The-Bias-Variance-Tradeoff.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/goodboychan/goodboychan.github.io/main?filepath=_notebooks%2F2020-06-03-02-The-Bias-Variance-Tradeoff.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/goodboychan/goodboychan.github.io/blob/main/_notebooks/2020-06-03-02-The-Bias-Variance-Tradeoff.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fgoodboychan%2Fgoodboychan.github.io%2Fblob%2Fmain%2F_notebooks%2F2020-06-03-02-The-Bias-Variance-Tradeoff.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Generalization-Error">Generalization Error </a></li>
<li class="toc-entry toc-h2"><a href="#Diagnose-bias-and-variance-problems">Diagnose bias and variance problems </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Instantiate-the-model">Instantiate the model </a>
<ul>
<li class="toc-entry toc-h4"><a href="#Preprocess">Preprocess </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#Evaluate-the-10-fold-CV-error">Evaluate the 10-fold CV error </a></li>
<li class="toc-entry toc-h3"><a href="#Evaluate-the-training-error">Evaluate the training error </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Ensemble-Learning">Ensemble Learning </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Define-the-ensemble">Define the ensemble </a>
<ul>
<li class="toc-entry toc-h4"><a href="#Preprocess">Preprocess </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#Evaluate-individual-classifiers">Evaluate individual classifiers </a></li>
<li class="toc-entry toc-h3"><a href="#Better-performance-with-a-Voting-Classifier">Better performance with a Voting Classifier </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-06-03-02-The-Bias-Variance-Tradeoff.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generalization-Error">
<a class="anchor" href="#Generalization-Error" aria-hidden="true"><span class="octicon octicon-link"></span></a>Generalization Error<a class="anchor-link" href="#Generalization-Error"> </a>
</h2>
<ul>
<li>Supervised Learning - Under the Hood<ul>
<li>supervised learning: $y = f(x)$, $f$ is unknown.</li>
<li>Goals<ul>
<li>Find a model $\hat{f}$ that best approximates: $f: \hat{f} \approx f$</li>
<li>$\hat{f}$ can be Logistic Regression, Decision Tree, Neural Network,...</li>
<li>Discard noise as much as possible</li>
<li>
<strong>End goal</strong>: $\hat{f}$ should achieve a low predictive error on unseen datasets.</li>
</ul>
</li>
</ul>
</li>
<li>Difficulties in Approximating $f$<ul>
<li>Overfitting: $\hat{f}(x)$ fits the training set noise.</li>
<li>Underfitting: $\hat{f}$ is not flexible enough to approximate $f$.</li>
</ul>
</li>
<li>Generalization Error<ul>
<li>Generalization Error of $\hat{f}$: Does $\hat{f}$ generalize well on unseen data?</li>
<li>It can be decomposed as follows:
$$ \hat{f} = \text{bias}^2 + \text{variance} +\text{irreducible error} $$</li>
<li>Bias: error term that tells you, on average, how much $\hat{f} \neq f$.
<img src="/images/copied_from_nb/image/bias.png" alt="bias">
</li>
<li>Variance: tells you how much $\hat{f}$ is inconsistent over different training sets
<img src="/images/copied_from_nb/image/variance.png" alt="variance">
</li>
</ul>
</li>
<li>Model Complexity<ul>
<li>Model Complexity: sets the flexibility of $\hat{f}$</li>
<li>Example: Maximum tree depth, Minimum samples per leaf, ...</li>
</ul>
</li>
<li>Bias-Variance Tradeoff
<img src="/images/copied_from_nb/image/ge.png" alt="">
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Diagnose-bias-and-variance-problems">
<a class="anchor" href="#Diagnose-bias-and-variance-problems" aria-hidden="true"><span class="octicon octicon-link"></span></a>Diagnose bias and variance problems<a class="anchor-link" href="#Diagnose-bias-and-variance-problems"> </a>
</h2>
<ul>
<li>Estimating the Generalization Error<ul>
<li>How do we estimate the generalization error of a model?<ul>
<li>Cannot be done directly because:<ul>
<li>$f$ is unknown</li>
<li>usually you only have one dataset</li>
<li>noise is unpredictable.</li>
</ul>
</li>
</ul>
</li>
<li>Solution<ul>
<li>Split the data to training and test sets</li>
<li>fit $\hat{f}$ to the training set</li>
<li>evaluate the error of $\hat{f}$ on the unseen test set</li>
<li>generalization error of $\hat{f} \approx$ test set error of $\hat{f}$</li>
</ul>
</li>
</ul>
</li>
<li>Better model Evaluation with Cross-Validation<ul>
<li>Test set should not be touched until we are confident about $\hat{f}$'s performance</li>
<li>Evaluating $\hat{f}$ on training set: biased estimate, $\hat{f}$ has already seen all training points</li>
<li>Solution: Cross-Validation (CV)<ul>
<li>K-Fold CV</li>
<li>Hold-Out CV</li>
</ul>
</li>
</ul>
</li>
<li>K-Fold CV
  $$\text{CV error} = \dfrac{E_1 + \cdots + E_{10}}{10} $$</li>
<li>Diagnose Variance Problems<ul>
<li>If $\hat{f}$ suffers from <strong>high variance</strong>: CV error of $\hat{f} &gt;$ training set error of $\hat{f}$<ul>
<li>$\hat{f}$ is said to overfit the training set. To remedy overfitting:<ul>
<li>Decrease model complexity</li>
<li>Gather more data, ...</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Diagnose Bias Problems<ul>
<li>if $\hat{f}$ suffers from high bias: CV error of $\hat{f} \approx$ training set error of $\hat{f} &gt;&gt;$ desired error.</li>
<li>$\hat{f}$ is said to underfit the training set. To remedy underfitting:<ul>
<li>Increase model complexity</li>
<li>Gather more relevant features</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Instantiate-the-model">
<a class="anchor" href="#Instantiate-the-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Instantiate the model<a class="anchor-link" href="#Instantiate-the-model"> </a>
</h3>
<p>In the following set of exercises, you'll diagnose the bias and variance problems of a regression tree. The regression tree you'll define in this exercise will be used to predict the mpg consumption of cars from the auto dataset using all available features.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Preprocess">
<a class="anchor" href="#Preprocess" aria-hidden="true"><span class="octicon octicon-link"></span></a>Preprocess<a class="anchor-link" href="#Preprocess"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mpg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/auto.csv'</span><span class="p">)</span>
<span class="n">mpg</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>displ</th>
      <th>hp</th>
      <th>weight</th>
      <th>accel</th>
      <th>origin</th>
      <th>size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.0</td>
      <td>250.0</td>
      <td>88</td>
      <td>3139</td>
      <td>14.5</td>
      <td>US</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.0</td>
      <td>304.0</td>
      <td>193</td>
      <td>4732</td>
      <td>18.5</td>
      <td>US</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>36.1</td>
      <td>91.0</td>
      <td>60</td>
      <td>1800</td>
      <td>16.4</td>
      <td>Asia</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18.5</td>
      <td>250.0</td>
      <td>98</td>
      <td>3525</td>
      <td>19.0</td>
      <td>US</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>34.3</td>
      <td>97.0</td>
      <td>78</td>
      <td>2188</td>
      <td>15.8</td>
      <td>Europe</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mpg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">mpg</span><span class="p">)</span>
<span class="n">mpg</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>displ</th>
      <th>hp</th>
      <th>weight</th>
      <th>accel</th>
      <th>size</th>
      <th>origin_Asia</th>
      <th>origin_Europe</th>
      <th>origin_US</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.0</td>
      <td>250.0</td>
      <td>88</td>
      <td>3139</td>
      <td>14.5</td>
      <td>15.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.0</td>
      <td>304.0</td>
      <td>193</td>
      <td>4732</td>
      <td>18.5</td>
      <td>20.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>36.1</td>
      <td>91.0</td>
      <td>60</td>
      <td>1800</td>
      <td>16.4</td>
      <td>10.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18.5</td>
      <td>250.0</td>
      <td>98</td>
      <td>3525</td>
      <td>19.0</td>
      <td>15.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>34.3</td>
      <td>97.0</td>
      <td>78</td>
      <td>2188</td>
      <td>15.8</td>
      <td>10.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">mpg</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'mpg'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">'columns'</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">[</span><span class="s1">'mpg'</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>

<span class="c1"># Set SEED for reproducibility</span>
<span class="n">SEED</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Split the data into 70% train and 30% test</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>

<span class="c1"># Instantiate a DecisionTreeRegressor dt</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mf">0.26</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Evaluate-the-10-fold-CV-error">
<a class="anchor" href="#Evaluate-the-10-fold-CV-error" aria-hidden="true"><span class="octicon octicon-link"></span></a>Evaluate the 10-fold CV error<a class="anchor-link" href="#Evaluate-the-10-fold-CV-error"> </a>
</h3>
<p>In this exercise, you'll evaluate the 10-fold CV Root Mean Squared Error (RMSE) achieved by the regression tree <code>dt</code> that you instantiated in the previous exercise.</p>
<p>Note that since <code>cross_val_score</code> has only the option of evaluating the negative MSEs, its output should be multiplied by negative one to obtain the MSEs. The CV RMSE can then be obtained by computing the square root of the average MSE.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>

<span class="c1"># Compute the array containing the 10-folds CV MSEs</span>
<span class="n">MSE_CV_scores</span> <span class="o">=</span> <span class="o">-</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                                 <span class="n">scoring</span><span class="o">=</span><span class="s1">'neg_mean_squared_error'</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Compute the 10-folds CV RMSE</span>
<span class="n">RMSE_CV</span> <span class="o">=</span> <span class="p">(</span><span class="n">MSE_CV_scores</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">**</span> <span class="mf">0.5</span>

<span class="c1"># Print RMSE_CV</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'CV RMSE: </span><span class="si">{:.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">RMSE_CV</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CV RMSE: 5.14
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Evaluate-the-training-error">
<a class="anchor" href="#Evaluate-the-training-error" aria-hidden="true"><span class="octicon octicon-link"></span></a>Evaluate the training error<a class="anchor-link" href="#Evaluate-the-training-error"> </a>
</h3>
<p>You'll now evaluate the training set RMSE achieved by the regression tree dt that you instantiated in a previous exercise.</p>
<p>Note that in scikit-learn, the MSE of a model can be computed as follows:</p>
<div class="highlight"><pre><span></span><span class="n">MSE_model</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_predicted</span><span class="p">)</span>
</pre></div>
<p>where we use the function mean_squared_error from the <code>metrics</code> module and pass it the true labels <code>y_true</code> as a first argument, and the predicted labels from the model <code>y_predicted</code> as a second argument.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span> <span class="k">as</span> <span class="n">MSE</span>

<span class="c1"># Fit dt to the training set</span>
<span class="n">dt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Predict the labels of the training set</span>
<span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="c1"># Evaluate the training set RMSE of dt</span>
<span class="n">RMSE_train</span> <span class="o">=</span> <span class="p">(</span><span class="n">MSE</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">))</span> <span class="o">**</span> <span class="mf">0.5</span>

<span class="c1"># Print RMSE_train</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Train RMSE: </span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">RMSE_train</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Train RMSE: 5.15
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Ensemble-Learning">
<a class="anchor" href="#Ensemble-Learning" aria-hidden="true"><span class="octicon octicon-link"></span></a>Ensemble Learning<a class="anchor-link" href="#Ensemble-Learning"> </a>
</h2>
<ul>
<li>Advantages of CARTs<ul>
<li>Simple to understand</li>
<li>Simple to interpret</li>
<li>Easy to use</li>
<li>Flexibility: ability to describe non-linear dependencies.</li>
<li>Preprocessing: no need to standardize or normalize features.</li>
</ul>
</li>
<li>Limitations of CARTs<ul>
<li>Classification: can only produce orthogonal decision boundaries</li>
<li>Sensitive to small variations in the training set</li>
<li>High variance: unconstrained CARTs may overfit the training set</li>
<li>Solution: <strong>ensemble learning</strong>
</li>
</ul>
</li>
<li>Ensemble Learning<ul>
<li>Train different models on the same dataset.</li>
<li>Let each model make its predictions</li>
<li>Meta-Model: aggregates predictionsof individual models</li>
<li>Final prediction: more robust and less prone to errors</li>
<li>Best results: models are skillfull in different ways.
<img src="/images/copied_from_nb/image/ensemble.png" alt="ensemble">
</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Define-the-ensemble">
<a class="anchor" href="#Define-the-ensemble" aria-hidden="true"><span class="octicon octicon-link"></span></a>Define the ensemble<a class="anchor-link" href="#Define-the-ensemble"> </a>
</h3>
<p>In the following set of exercises, you'll work with the <a href="https://www.kaggle.com/jeevannagaraj/indian-liver-patient-dataset">Indian Liver Patient Dataset</a> from the UCI Machine learning repository.</p>
<p>In this exercise, you'll instantiate three classifiers to predict whether a patient suffers from a liver disease using all the features present in the dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Preprocess">
<a class="anchor" href="#Preprocess" aria-hidden="true"><span class="octicon octicon-link"></span></a>Preprocess<a class="anchor-link" href="#Preprocess"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">indian</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/indian_liver_patient_preprocessed.csv'</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">indian</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age_std</th>
      <th>Total_Bilirubin_std</th>
      <th>Direct_Bilirubin_std</th>
      <th>Alkaline_Phosphotase_std</th>
      <th>Alamine_Aminotransferase_std</th>
      <th>Aspartate_Aminotransferase_std</th>
      <th>Total_Protiens_std</th>
      <th>Albumin_std</th>
      <th>Albumin_and_Globulin_Ratio_std</th>
      <th>Is_male_std</th>
      <th>Liver_disease</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.247403</td>
      <td>-0.420320</td>
      <td>-0.495414</td>
      <td>-0.428870</td>
      <td>-0.355832</td>
      <td>-0.319111</td>
      <td>0.293722</td>
      <td>0.203446</td>
      <td>-0.147390</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.062306</td>
      <td>1.218936</td>
      <td>1.423518</td>
      <td>1.675083</td>
      <td>-0.093573</td>
      <td>-0.035962</td>
      <td>0.939655</td>
      <td>0.077462</td>
      <td>-0.648461</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.062306</td>
      <td>0.640375</td>
      <td>0.926017</td>
      <td>0.816243</td>
      <td>-0.115428</td>
      <td>-0.146459</td>
      <td>0.478274</td>
      <td>0.203446</td>
      <td>-0.178707</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.815511</td>
      <td>-0.372106</td>
      <td>-0.388807</td>
      <td>-0.449416</td>
      <td>-0.366760</td>
      <td>-0.312205</td>
      <td>0.293722</td>
      <td>0.329431</td>
      <td>0.165780</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.679294</td>
      <td>0.093956</td>
      <td>0.179766</td>
      <td>-0.395996</td>
      <td>-0.295731</td>
      <td>-0.177537</td>
      <td>0.755102</td>
      <td>-0.930414</td>
      <td>-1.713237</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">indian</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'Liver_disease'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">'columns'</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">indian</span><span class="p">[</span><span class="s1">'Liver_disease'</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span> <span class="k">as</span> <span class="n">KNN</span>

<span class="c1"># Set seed for reproducibility</span>
<span class="n">SEED</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Instantiate lr</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>

<span class="c1"># Instantiate knn</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNN</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>

<span class="c1"># Instantiate dt</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">min_samples_leaf</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>

<span class="c1"># Define the list classifiers</span>
<span class="n">classifiers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">'Logistic Regression'</span><span class="p">,</span> <span class="n">lr</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">'K Nearest Neighbors'</span><span class="p">,</span> <span class="n">knn</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">'Classification Tree'</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Evaluate-individual-classifiers">
<a class="anchor" href="#Evaluate-individual-classifiers" aria-hidden="true"><span class="octicon octicon-link"></span></a>Evaluate individual classifiers<a class="anchor-link" href="#Evaluate-individual-classifiers"> </a>
</h3>
<p>In this exercise you'll evaluate the performance of the models in the list classifiers that we defined in the previous exercise. You'll do so by fitting each classifier on the training set and evaluating its test set accuracy.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="c1"># Iterate over the pre-defined list of classifiers</span>
<span class="k">for</span> <span class="n">clf_name</span><span class="p">,</span> <span class="n">clf</span> <span class="ow">in</span> <span class="n">classifiers</span><span class="p">:</span>
    <span class="c1"># Fit clf to the training set</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Predict y_pred</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    
    <span class="c1"># Calculate accuracy</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    
    <span class="c1"># Evaluate clf's accuracy on the test set</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="si">{:s}</span><span class="s1"> : </span><span class="si">{:.3f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">clf_name</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Logistic Regression : 0.759
K Nearest Neighbors : 0.701
Classification Tree : 0.730
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Better-performance-with-a-Voting-Classifier">
<a class="anchor" href="#Better-performance-with-a-Voting-Classifier" aria-hidden="true"><span class="octicon octicon-link"></span></a>Better performance with a Voting Classifier<a class="anchor-link" href="#Better-performance-with-a-Voting-Classifier"> </a>
</h3>
<p>Finally, you'll evaluate the performance of a voting classifier that takes the outputs of the models defined in the list classifiers and assigns labels by majority voting.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">VotingClassifier</span>

<span class="c1"># Instantiate a VotingClassifier vc</span>
<span class="n">vc</span> <span class="o">=</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="n">classifiers</span><span class="p">)</span>

<span class="c1"># Fit vs to the training set</span>
<span class="n">vc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Evaluate the test set predictions</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">vc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Calculate accuracy score</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Voting Classifier: </span><span class="si">{:.3f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Voting Classifier: 0.770
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="goodboychan/goodboychan.github.io"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/python/datacamp/machine_learning/2020/06/03/02-The-Bias-Variance-Tradeoff.html" hidden></a>
</article>